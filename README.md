# FarmScript

This is my implementation of the *first* interpreter described in the book [Crafting Interpreters](https://craftinginterpreters.com/index.html) by Robert Nystrom.

## Lox

"Lox" is a small object oriented language that looks like Javascript. You can check some [examples in the book](https://craftinginterpreters.com/the-lox-language.html).

## Implementation

The book implements the first interpreter (jlox) in Java, but I wanted to practice C++ a little bit more and decided to give it a go. It was a big challenge though, and I had to cut some corners and hack my way out of a few complicated issues (memory management, pointers, error handling, etc).

## Structure

A short description for the main files:

```
FarmScript
│   
│   main.cpp           	       Main entry point
│   FarmScript.[cpp,h]         Main runtime
│   Token.[cpp.h]              Tokens generated by scanner
│   Scanner.[cpp,h]            Lexycal analyzer (splits input into tokens for the parser)
│   Parser.[cpp,h]             Parses tokens into Abstract Syntax Tree (AST)
│   Resolver.[cpp,h]           Resolves names references for interpreter
│   Interpreter.[cpp,h]        Main tree interpreter
│   Expr.[cpp,h]               AST - Classes for expressions
│   Stmt.[cpp.h]               AST - Classes for statements
│   List*.[cpp,h]              AST - Helper classes
│   Object.[cpp,h]             Basic Lox value
│   Lox*.[cpp,h]               Classes to represent Lox values like classes, functions, etc
│   NativeFunctions.h          Native function implementations callable from Lox code
│
├───lox-generate-ast           Utility to generate the AST classes for expressions and statements
│
└───lox-ast-printer            Test program to print the tree representation for the AST
```

Modules:

```
                                   ┌──────────┐
                                   │ Resolver ├──► Variable bindings
                                   └──────────┘          │
                                         ▲               ▼
┌─────────┐            ┌────────┐        │        ┌─────────────┐
│ Scanner ├─► Tokens ─►│ Parser ├─────► AST ─────►│ Interpreter │
└─────────┘            └────────┘                 └─────────────┘
```

## Building

The project/solution was created in linux.
```
make
```

## Usage

Run in interactively (currently, no support for multiline statements in REPL mode):

```
lox-cpp
```

Pass a script as an argument:

```
farmscript program.fs
```

From standard input:

```
farmscript < program.fs

-- or --

cat program.fs | farmscript
```
